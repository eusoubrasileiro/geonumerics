Add to the c code :

Trapezoidal Low pass
FFt convolution
Hanning window

My fft is Perfect.just create the IFFT!!