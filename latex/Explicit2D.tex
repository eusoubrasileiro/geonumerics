\documentclass[legalpaper, 12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphics}
\usepackage{xcolor}
\usepackage[pdftex]{hyperref}

\begin{document}

Von Newman stability analysis for acoustic wave equation explicit centered differences: 2nd order time and space (N 2)'th order:


\begin{multline}
U_{jk}^{n+1}  =  \left( \frac{\Delta t  V_{jk} }{\Delta s} \right) ^2 \left(  \sum_{a=-N}^N w_a U_{j+a k}^n + \sum_{a=-N}^N w_a U_{j k+a}^n \right) + 2 U_{jk}^{n} - U_{jk}^{n-1}  \\
U_{jk}^{n+1}  =  \left( \frac{\Delta t  V_{jk}}{\Delta s} \right) ^2  \sum_{a=-N}^N  w_a \left( U_{j+a k}^n + U_{j k+a}^n \right) + 2 U_{jk}^{n} - U_{jk}^{n-1} \label{1}
\end{multline}

For forth order space, we have $N=2$ and $w$ is:
$$ w = \frac{1}{12} [-1, 16, -30, 16, -1] $$

Can also be simplified to 1st order (N=1):

\begin{equation}
U_{jk}^{n+1}  =  \left( \frac{\Delta t  V_{jk}}{\Delta s} \right) ^2 \left(  U_{j+1k}^n - 4 U_{jk}^n + U_{jk+1}^n + U_{j-1k}^n + U_{jk-1}^n  \right) + 2 U_{jk}^{n} - U_{jk}^{n-1} \nonumber
\end{equation}


Using the discrete solution for 2D wave equation, where $ i = \sqrt{-1} $, $ n = n \Delta t $, $ j = j \Delta x $ and $ k = k \Delta z $. Last using $ \Delta x = \Delta z = \Delta s $, follows that the discrete solution can be written as:

\begin{eqnarray}
U_{jk}^n = e^{i \left( \omega t + px + qz \right)} \nonumber \\
U_{jk}^n = \epsilon^n e^{i \left( pj\Delta s + qk\Delta s \right)}  \nonumber \\
U_{jk}^n = \epsilon^n e^{i \Delta s \left( pj + qk \right)}  \label{2}
\end{eqnarray}

Where $\epsilon $ is the growth factor, and should be $ |\epsilon| \leq 1$ for stability. \\

Replacing (\ref{2}) in (\ref{1}), using the identities bellow and simplifying dividing both sides by $ U_{jk}^{n+1} $

$$ r = \frac{\Delta t  V_{jk}}{\Delta s} $$
$$ \phi_{j+l\ k+m} = e^{i \Delta s \left( pl+qm \right)} $$

\begin{equation}
\Omega = r^2 \sum_{a=-N}^N  w_a \left( \phi_{j+a k} + \phi_{j k+a}  \right) \label{3}
\end{equation}

we get:

\begin{eqnarray}
1  =  \left( \Omega + 2 \right) \epsilon^{-1} -\epsilon^{-2} \nonumber \\
\quad \text{making} \ \ \epsilon^{-1} = \mu \nonumber \\
\mu^2 - \left( \Omega + 2 \right) \mu + 1 = 0 \nonumber \\
\mu = \frac{(\Omega+2) \pm \sqrt{\Omega^2 + 4\Omega}}{2} \label{4}
\end{eqnarray}

back to expand $ \Omega $ defined in (\ref{3}):

\begin{eqnarray}
\Omega &=& r^2 \sum_{a=-N}^N  w_a \left( \phi_{j+a k} + \phi_{j k+a}  \right) \nonumber \\
	&=& r^2 \sum_{a=-N}^{N} w_a ( e^{i \Delta s \ p a} + e^{i \Delta s \ q a} )\nonumber 
\end{eqnarray}
\begin{equation}
=r^2
\begin{pmatrix}
 \cdots & e^{-i \Delta s 2 p} + e^{-i \Delta s 2 q} & e^{-i \Delta s p} + e^{-i \Delta s q} & e^0+e^0 & e^{i \Delta s p} + e^{i \Delta s q} & e^{i \Delta s 2 p} + e^{i \Delta s 2 q} & \cdots \\
\end{pmatrix}
\begin{pmatrix}
\cdots \\
w_{-2} \\
w_{-1} \\
w_0 \\
w_1 \\
w_2 \\
\cdots
\end{pmatrix}
\nonumber
\end{equation}

Since $w$ is even $ w_a = w_{-a} $ and $ e^{i\theta} + e^{-i\theta} = 2 \cos{\theta} $ we can rewrite as:

\begin{equation}
=r^2
\begin{pmatrix}
 \cdots & 2\cos( \Delta s 2 p) + 2\cos(\Delta s 2 q) & 2\cos(\Delta s p) + 2\cos(\Delta s q) & 2 \\
\end{pmatrix}
\begin{pmatrix}
\cdots \\
w_{2} \\
w_{1} \\
w_0 \\
\end{pmatrix}
\nonumber
\end{equation}

For the simplest case 2nd order $ N=1 $ we have $ (w_1, w_0) = (1, -2) $

\begin{eqnarray}
\Omega	&=& r^2 \left( 2\cos(\Delta s p) + 2\cos(\Delta s q) - 4\right) \nonumber \\
	&=& -4r^2 \left( \sin^2(\frac{\Delta s p}{2}) + \sin^2(\frac{\Delta s q}{2}) \right) \label{5}
\end{eqnarray}

Note:  $ 2 \cos(\theta) - 2 = -4 \sin ^2 (\theta) $ .\\

We can also write (\ref{5}) using $ \beta = \left( \sin^2(\frac{\Delta s p}{2}) + \sin^2(\frac{\Delta s q}{2}) \right) $ as :

$$ \Omega = -4r^2\beta $$

Replacing back to (\ref{4}) :

\begin{eqnarray}
\mu &=& \frac{(\Omega+2) \pm \sqrt{\Omega^2 + 4\Omega}}{2} \nonumber \\
\mu &=& -2r^2\beta+1 \pm 2\sqrt{r^2\beta(r^2\beta-1)} \label{6}
\end{eqnarray}

I can't find if $ | \mu | \geq 1 $ or what limitations I have in $r$ for this requeriment, that is the same as needing $ | \epsilon | \leq 1  $. 

\newpage

\textit{My own solution.}

Not certain if its a \textit{proof by contradiction} but seans to be hehehe. 

\textbf{Supose $ \Delta > 0 $ condition holds} for $ | \epsilon |  \leq 1 $ that using $ \epsilon^{-1} = \mu $ means $ |\mu| \geq 1 $. Thus this requires (look at \ref{6}) for $ r^2 \beta - 1 > 0 $   to be $ r > \frac{1}{ \sqrt{ \beta} } $  that can be satisfied by using $ r = \frac{1}{ \sqrt{ \beta} } + \psi $ with $ \psi > 0 $ positive, real. 

Going back to \ref{6} for the first root $ \mu{'} $, we have:

\begin{eqnarray}
\mu^{'} &=& -2r^2\beta+1 + 2\sqrt{r^2\beta(r^2\beta-1)} \nonumber \\
	&=& -2r^2\beta+1 + 2\sqrt{r^2\beta(r^2\beta-1)} \nonumber \\
	&=& -2 \left(1+\frac{2\psi\beta}{\sqrt{\beta}} + \psi^2\beta\right)+1+ 2\sqrt{\left(1+\frac{2\psi\beta}{\sqrt{\beta}} + \psi^2\beta\right)\left[\left(1+\frac{2\psi\beta}{\sqrt{\beta}} + \psi^2\beta\right)-1 \right]} \nonumber \\
	&=& -2 	\left(1+2\psi\sqrt{\beta}+\psi^2\beta\right) +1 + 2 \sqrt{\left(1+2\psi\sqrt{\beta}+\psi^2\beta\right)\left[\left(1+2\psi\sqrt{\beta}+\psi^2\beta\right)-1\right]} \nonumber \\
	&=& -2 A + 1 + 2\sqrt{A^2-A} \label{7}
\end{eqnarray}

With:

\begin{equation}
A = \left(1+2\psi\sqrt{\beta}+\psi^2\beta\right) \label{8}
\end{equation}

Note that since $ \psi > 1 $ then $ A > 1 $ always. Using the requeriment for stability:
\begin{eqnarray}
| \mu^{'} | &\geq& 1 \nonumber \\
	\left|-2 A + 1 + 2\sqrt{A^2-A}\right| &\geq& 1  \nonumber \\
	\text{To satisfy the inequality, two possibilities} &.&\nonumber \\
    -2 A + 1 + 2\sqrt{A^2-A} &\leq& -1  \nonumber \\
	-2 A + 1 + 2\sqrt{A^2-A} &\geq& 1  \nonumber \\ 
	-2 A + 2\sqrt{A^2-A} &\leq& -2  \label{9} \\
    -2 A + 2\sqrt{A^2-A} &\geq& 0  \label{10} 
\end{eqnarray}

At \ref{9} for $ A > 1 $ left hand side cannot hold, always $ > -2 $. 
At \ref{10} for $ A > 1 $ also cannot hold, $ -1 > left hand side > -2 $
We don't even need to look at the second root. 


This implies that $ \Delta > 0 $ doesn't satisfy the stability criteria. 

\newpage

Be reminded of inequalites with absolute values:

$$ |x-3| \leq 9 \implies -9 \leq x - 3 \leq 9 \implies  -6 \leq x \leq 12 $$

\newpage

Jing-Bo Chen, \\
\bigskip

Convergence given by:

$$ r = \frac{V \Delta t}{\Delta s} $$ 

Where $ V $ is the maximum of $ V_{jk} $ 

$$ r \leq \frac{2}{\sqrt{\sum_{a=-N}^{N} (|w_a^1| + |w_a^2|)}} $$

Reminded that $w_a$ is the centered finite diferences weights and the indexes 1 e 2 refer to the x and y dimensions.

Can writen as limitation to $ \Delta t $ :

$$ \Delta t \leq \frac{2 \Delta s}{ V \sqrt{\sum_{a=-N}^{N} (|w_a^1| + |w_a^2|)}} $$

Examples, 
Second order schema :

$$ \Delta t \leq \frac{2 \Delta s}{ V \sqrt{2(1+2+1)}} \implies \Delta t \leq \frac{ \Delta s}{ V \sqrt{2}} $$

Forth order schema :

$$ \Delta t \leq \frac{2 \Delta s}{ V \sqrt{2/12(1+16+30+16+1)}} \implies \Delta t \leq \frac{ \Delta s \sqrt{8}}{ V 3} = \frac{ \Delta s \sqrt{8}}{ V 3}$$

\newpage

References previous page

[1] Alford R.M., Kelly K.R., Boore D.M. (1974) Accuracy of finite-difference modeling of the acoustic wave equation Geophysics, 39 (6), P. 834-842

[2] Chen, Jing-Bo (2011) A stability formula for Lax-Wendroff methods with fourth-order in time and general-order in space for the scalar wave equation Geophysics, v. 76, p. T37-T42

\newpage

Altough the schema above is stable under the given condition, quotting from scicomp:

The first order upwind method is monotone; it does not introduce spurious oscillations. But it is only first order accurate, resulting in so much numerical diffusion as to be unusable for many purposes. Godunov's Theorem states that linear spatial discretizations of higher than first order cannot be monotone.

So Lets try the first order, altough it might be dispersive as well in regions of high $ \nabla = ( \frac{\partial}{\partial x}, \frac{\partial}{\partial y} ) $ Should take a look on S*U implementation! Book bought! Loook at implementation!


\newpage


\medspace
\medspace
Advection form of 2D Wave equation:
\medspace

$$ \frac{\partial U}{\partial t ^2} = v^2 \nabla^2 U $$ 

using $\theta = \nabla U $ and 


\end{document}}